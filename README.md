# 基于华为云的Hadoop-Spark存算分离脚本统计小说角色名频次

## 项目简介

本项目旨在通过 **华为云** 的 **Hadoop-Spark 存算分离** 方案，统计小说文本中角色名称的出现频次。存算分离架构将计算资源与存储资源解耦，利用 Spark 的分布式计算能力，对大规模小说文本进行高效处理。

---

## 功能概述

1. **文本解析**：将小说文本分段解析，提取可能的角色名称。
2. **角色名称过滤**：通过正则表达式或字典校验过滤非角色名称。
3. **频次统计**：统计每个角色名称的出现次数。
4. **结果存储**：将统计结果存储在华为云 OBS 或 HDFS 上，支持多种输出格式（如 CSV 或 Parquet）。

---

## 系统架构

1. **存储**：
   - 华为云对象存储服务 (OBS)：用于存储原始小说文本与结果文件。
   - HDFS：用于中间数据的存储。

2. **计算**：
   - Spark：用于分布式计算和角色名频次统计。
   - 使用 Spark 的 RDD 或 DataFrame API 实现高效计算。

3. **资源调度**：
   - 华为云 MRS 服务：管理 Hadoop 和 Spark 资源。
   - 存算分离架构将数据存储在 OBS 上，计算任务动态使用计算节点完成。

---

## 环境要求

1. **华为云资源**：
   - OBS 存储桶（用于存储小说文本与输出结果）。
   - MRS 集群（包含 Hadoop 和 Spark 环境）。

2. **开发工具**：
   - Spark
   - Hadoop
   - Python

---

## 使用方法

### 1. 数据准备

- 将小说文本（如 `.txt` 文件）上传到华为云 OBS 的指定路径。
- 确保文本编码为 UTF-8。

### 2. 华为云构建Hadoop-Spark集群

略，可自行网上查找教程
```

### 3. 脚本运行

- 提交 Spark 作业：
  ```bash
  spark-submit SparkMain_run.py
  ```

---

## 脚本结构

### `SparkMain_run.py`

1. **OBS 数据加载**
   - 使用 spark.read.text API 从 OBS 加载小说文本。

2. **文本解析与清洗**
   - 通过jieba分词提取可能的角色名称。
   - 通过词汇标签过滤得到角色名

3. **频次统计**
   - 使用 RDD 或 DataFrame 进行 `reduceByKey` 或 `groupBy` 操作，统计频次。

4. **结果保存**
   - 将统计结果保存到指定的 OBS 输出路径。

---

## 示例输出

输出格式为 txt 文件，包含以下字段：

| 角色名称 | 出现频次 |
|----------|----------|
| 张三     | 120      |
| 李四     | 95       |
| 王五     | 78       |



## 注意事项

1. 角色名称提取的准确性依赖于jieba分词的准确率，可以尝试其他nlp库，例如hanlp或者LAC。
2. 确保 OBS 配置了正确的访问权限。
3. 如任务规模较大，请合理规划 MRS 集群资源。

---

## 授权协议

本项目遵循 MIT 开源协议，欢迎二次开发和商业使用。

---

## 联系方式

如有问题，请联系：

- **开发者**：XXX
- **邮箱**：xxx@example.com
- **华为云支持**：[https://support.huaweicloud.com](https://support.huaweicloud.com)